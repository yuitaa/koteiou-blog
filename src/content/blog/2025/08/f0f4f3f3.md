---
title: '視聴したアニメをNotionに同期する'
pubDate: 2025-08-10
tags: ['Annict', 'アニメ', 'Notion']
image: '/cover/2025/n3243ddb1744e_c94d5ca1114beeba204417987903a19d.jpeg'
---

最近、アニメの視聴記録に [Annict](https://annict.com/) というサービスを使っている。Annict の提供する API を提供し、アニメの記録などのデータを取得できる。これを使って自分の視聴している/したアニメを Notion に自動で反映させるようにしたい。

![](@/assets/2025/08/n3243ddb1744e_1751626585-JF5oVjbfwHBKiNkMEuOI46r9.png)

https://annict.com/

## Annictからデータを持ってくる

https://developers.annict.com/docs/rest-api/v1/works#get-v1meworks

API を使ってデータを持ってこよう。`/v1/me/works` から自分が記録をつけているアニメの一覧を持ってこれる。`filter_status` で見てる(watching)・見た(wathed) もののみをフィルター。

```http
GET /v1/me/works?filter_status=watching HTTP/1.1
Host: api.annict.com
Authorization: <Annictのアクセストークン>
```

works に以下のような作品データが入っている。

```json
{
  "id": 13792,
  "title": "ウィッチウォッチ",
  "title_kana": "うぃっちうぉっち",
  "title_en": "WITCH WATCH",
  "media": "tv",
  "media_text": "TV",
  "released_on": "",
  "released_on_about": "",
  "official_site_url": "https://witchwatch-anime.com/",
  "wikipedia_url": "https://ja.wikipedia.org/wiki/%E3%82%A6%E3%82%A3%E3%83%83%E3%83%81%E3%82%A6%E3%82%A9%E3%83%83%E3%83%81",
  "twitter_username": "WITCHWATCHanime",
  "twitter_hashtag": "ウィッチウォッチ",
  "syobocal_tid": "7367",
  "mal_anime_id": "59597",
  "images": {
    "recommended_url": "",
    "facebook": {
      "og_image_url": "https://witchwatch-anime.com/wp/wp-content/themes/witchwatch-main/ogp3.png"
    },
    "twitter": {
      "mini_avatar_url": "https://twitter.com/WITCHWATCHanime/profile_image?size=mini",
      "normal_avatar_url": "https://twitter.com/WITCHWATCHanime/profile_image?size=normal",
      "bigger_avatar_url": "https://twitter.com/WITCHWATCHanime/profile_image?size=bigger",
      "original_avatar_url": "https://twitter.com/WITCHWATCHanime/profile_image?size=original",
      "image_url": ""
    }
  },
  "episodes_count": 14,
  "watchers_count": 1957,
  "reviews_count": 4,
  "no_episodes": false,
  "season_name": "2025-spring",
  "season_name_text": "2025年春",
  "status": {
    "kind": "watching"
  }
}
```

これを Notion に持っていきたい。

## Notion にデータベースをつくる

![](@/assets/2025/08/n3243ddb1744e_1751635877-40z13mEa6DfCUjXZw7qTyeoI.png)

Notion のデータベースではタイトルなど、各ページに持たせたいデータをプロパティとして作成する。プロパティの型によって使える機能が違ったりする。

### データ→Notion

Notion はページ操作などをする API を提供している。これを使ってデータを Notion に反映させる。

https://developers.notion.com/docs/working-with-databases

Notion ではデータベースの各アイテムは1つのページとして働く。データベースを親としてページを作成すれば、データベースにアイテムが作成される。

毎回ページを作ってしまうとデータベースのアイテムが実行毎に増えていくので、作ったページのデータを保存しておき、あとから編集する用に取っておこうとおもう。

## つくってく

JavaScriptでつくる、構成はこんな感じ。

```txt
annict-notion/
├── src/
│   ├── annict.js    # Annict APIからデータ取得
│   ├── notion.js    # Notion APIでDB操作
│   ├── config.js    # 設定・環境変数管理
│   └── main.js      # メイン処理
├── data/
│   └── data.json    # 同期済みデータのキャッシュ
├── .github/
│   └── workflows/
│       └── sync.yml # GitHub Actions用ワークフロー
├── .env
└── package.json
```

1. `src/annict.js` でAnnict API からアニメの一覧を取得する
2. `src/notion.js` でNotion APIを使い、データベースにアニメ情報を登録する
3. AnnictのデータをNotionのプロパティ形式に変換

### 差分管理

`data/data.json` で同期済みデータを管理し、
新規アニメはNotionページを作成、既存アニメはステータス変更時のみ更新する。

### メイン処理

`src/main.js` で「見てる」「見た」両方のステータスを順に同期。
同期結果はJSONで保存し、次回以降の差分検出に利用。

### 自動化

`.github/workflows/sync.yml` でGitHub Actionsを設定。
毎日自動で同期スクリプトを実行し、`data/data.json`の変更があればプッシュする。

## 完成

実行してみるとこんな感じ。ちゃんとデータを送れている。

![](@/assets/2025/08/n3243ddb1744e_1751632521-s2OmuWbCTUAGQJaXFZEn1SHP.png)

![](@/assets/2025/08/n3243ddb1744e_1751678963-mYpMlTjShqIb4oUxk2tQisz5.png)

API で取得した画像を設定し、ギャラリービューを追加した。いい感じ。

![](@/assets/2025/08/n3243ddb1744e_1751678987-76sJbdgUfemVNPlkIAK3aOnW.png)
